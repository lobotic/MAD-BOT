<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>MAD-BOT - Marcador</title>
<style>
  body {
    background-color: #470f18;
    color: #f1a140;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  header img {
    max-width: 200px;
    margin: 20px auto;
    display: block;
  }
  h1 { margin: 10px 0; }
  .timer {
    font-size: 2em;
    margin: 15px 0;
  }
  .teams {
    display: flex;
    justify-content: space-around;
    margin-top: 20px;
  }
  .team {
    flex: 1;
    margin: 10px;
    padding: 10px;
    border: 2px solid #e44942;
    border-radius: 10px;
    background-color: #b6c0c0;
    color: #470f18;
  }
  .team h2 { color: #e44942; }
  .score { font-size: 1.5em; margin-top: 10px; }
  button {
    margin: 5px;
    padding: 10px 15px;
    background-color: #e44942;
    border: none;
    border-radius: 5px;
    color: white;
    cursor: pointer;
  }
  button:hover { background-color: #f1a140; color: #470f18; }
  .checklist { text-align: left; margin-top: 10px; }
</style>
</head>
<body>

<header>
  <img src="https://ideogram.ai/g/gGGxV810RLyDEM00AEyGNw/2" alt="MAD-BOT Logo">
  <h1>MAD-BOT Competición</h1>
</header>

<div>
  <h2>Tiempo de partida</h2>
  <div id="mainTimer" class="timer">120</div>
  <button onclick="startAll()">Iniciar todos</button>
  <button onclick="stopAll()">Parar ambos</button>
  <button onclick="stopTeam(1)">Parar Equipo 1</button>
  <button onclick="stopTeam(2)">Parar Equipo 2</button>
</div>

<div class="teams">
  <div class="team" id="team1">
    <h2>Equipo 1</h2>
    <div id="team1Timer" class="timer">30</div>
    <div class="checklist">
      <h3>Reciclaje</h3>
      <label><input type="number" min="0" max="3" value="0" onchange="updateScore(1)"> Cilindros Azul</label><br>
      <label><input type="number" min="0" max="3" value="0" onchange="updateScore(1)"> Cilindros Amarillo</label><br>
      <label><input type="number" min="0" max="3" value="0" onchange="updateScore(1)"> Cilindros Verde</label><br>
      <label><input type="checkbox" onchange="updateScore(1)"> Bonus reciclaje (uno en cada color)</label><br>
      <label><input type="number" min="0" value="0" onchange="updateScore(1)"> Mal reciclados</label>
      <h3>Reforestación</h3>
      <label><input type="checkbox" onchange="updateScore(1)"> 1 árbol en pie (5 pts)</label><br>
      <label><input type="checkbox" onchange="updateScore(1)"> 2 árboles en pie (15 pts)</label><br>
      <label><input type="checkbox" onchange="updateScore(1)"> Árboles en dianas</label><br>
      <label><input type="checkbox" onchange="updateScore(1)"> Bonus un árbol en cada diana</label>
      <h3>Otros</h3>
      <label><input type="checkbox" onchange="updateScore(1)"> Acabar en zona FIN</label><br>
      <label><input type="checkbox" onchange="updateScore(1)"> Todos conducen</label>
    </div>
    <div class="score">Puntuación: <span id="score1">0</span></div>
  </div>

  <div class="team" id="team2">
    <h2>Equipo 2</h2>
    <div id="team2Timer" class="timer">30</div>
    <div class="checklist">
      <h3>Reciclaje</h3>
      <label><input type="number" min="0" max="3" value="0" onchange="updateScore(2)"> Cilindros Azul</label><br>
      <label><input type="number" min="0" max="3" value="0" onchange="updateScore(2)"> Cilindros Amarillo</label><br>
      <label><input type="number" min="0" max="3" value="0" onchange="updateScore(2)"> Cilindros Verde</label><br>
      <label><input type="checkbox" onchange="updateScore(2)"> Bonus reciclaje (uno en cada color)</label><br>
      <label><input type="number" min="0" value="0" onchange="updateScore(2)"> Mal reciclados</label>
      <h3>Reforestación</h3>
      <label><input type="checkbox" onchange="updateScore(2)"> 1 árbol en pie (5 pts)</label><br>
      <label><input type="checkbox" onchange="updateScore(2)"> 2 árboles en pie (15 pts)</label><br>
      <label><input type="checkbox" onchange="updateScore(2)"> Árboles en dianas</label><br>
      <label><input type="checkbox" onchange="updateScore(2)"> Bonus un árbol en cada diana</label>
      <h3>Otros</h3>
      <label><input type="checkbox" onchange="updateScore(2)"> Acabar en zona FIN</label><br>
      <label><input type="checkbox" onchange="updateScore(2)"> Todos conducen</label>
    </div>
    <div class="score">Puntuación: <span id="score2">0</span></div>
  </div>
</div>

<audio id="beep" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
let mainTime = 120;
let prepTime1 = 30, prepTime2 = 30;
let mainInterval, team1Interval, team2Interval;
let prepRunning1 = false, prepRunning2 = false;

function startAll(){
  stopAll();
  // Main timer
  mainTime = 120;
  document.getElementById("mainTimer").innerText = mainTime;
  mainInterval = setInterval(()=>{
    mainTime--;
    document.getElementById("mainTimer").innerText = mainTime;
    if(mainTime<=0){ clearInterval(mainInterval); document.getElementById("beep").play();}
  },1000);

  // Team 1 prep
  prepTime1 = 30;
  document.getElementById("team1Timer").innerText = prepTime1;
  prepRunning1=true;
  team1Interval = setInterval(()=>{
    if(prepTime1>0){ prepTime1--; }
    else { prepTime1++; } // penalización
    document.getElementById("team1Timer").innerText = prepTime1;
    if(prepTime1===0){ document.getElementById("beep").play(); }
  },1000);

  // Team 2 prep
  prepTime2 = 30;
  document.getElementById("team2Timer").innerText = prepTime2;
  prepRunning2=true;
  team2Interval = setInterval(()=>{
    if(prepTime2>0){ prepTime2--; }
    else { prepTime2++; } // penalización
    document.getElementById("team2Timer").innerText = prepTime2;
    if(prepTime2===0){ document.getElementById("beep").play(); }
  },1000);
}

function stopAll(){
  clearInterval(mainInterval);
  clearInterval(team1Interval);
  clearInterval(team2Interval);
}

function stopTeam(team){
  if(team===1){ clearInterval(team1Interval); prepRunning1=false;}
  if(team===2){ clearInterval(team2Interval); prepRunning2=false;}
}

function updateScore(team){
  let teamDiv = document.getElementById("team"+team);
  let inputs = teamDiv.querySelectorAll("input");
  let score=0;

  // Reciclaje (tres contenedores)
  let azul = parseInt(inputs[0].value)||0;
  let amarillo = parseInt(inputs[1].value)||0;
  let verde = parseInt(inputs[2].value)||0;

  function puntos(c){
    if(c===1) return 2;
    if(c===2) return 5;
    if(c===3) return 15;
    return 0;
  }
  score+=puntos(azul)+puntos(amarillo)+puntos(verde);

  if(inputs[3].checked) score+=10; // bonus reciclaje
  score-= (parseInt(inputs[4].value)||0)*5; // mal reciclados

  // Reforestación
  if(inputs[5].checked) score+=5;
  if(inputs[6].checked) score+=15;
  if(inputs[7].checked) score+=10; // árboles en dianas (simplificado)
  if(inputs[8].checked) score+=10;

  // Otros
  if(inputs[9].checked) score+=10; // zona fin
  if(inputs[10].checked) score+=15; // todos conducen

  document.getElementById("score"+team).innerText=score;
}
</script>
</body>
</html>
